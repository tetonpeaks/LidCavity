<!DOCTYPE html>
<html>
<head>
    <title>SocketIO Example</title>
</head>
<body>
    <h1>SocketIO Example</h1>

    <button id="startLoop">Start Loop</button>
    <button id="imgStream">Image Stream</button>
    <ul id="messages"></ul>


    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.0.1/socket.io.js"></script>
    <script type="text/javascript">

        const socketThreadingInfo = io.connect('http://' + document.domain + ':' + location.port + '/check_multithreading');
        socketThreadingInfo.emit('message', null);


        //var socketImgStream = io.connect('http://' + document.domain + ':' + location.port + '/test');

        document.getElementById('startLoop').addEventListener('click', () => {

            var socketStartLoop = io.connect('http://' + document.domain + ':' + location.port + '/image_stream');

            var socketRetreive = io.connect('http://' + document.domain + ':' + location.port + '/retreive');

            // Handle WebSocket messages from the server
            socketRetreive.on('background_data', function (message) {
                var messages = document.getElementById('messages');
                var li = document.createElement('li');
                li.appendChild(document.createTextNode(message));
                messages.appendChild(li);
            })
        });

        document.getElementById('imgStream').addEventListener('click', function () {

            var socketImgStream = io.connect('http://' + document.domain + ':' + location.port + '/test');

            socketImgStream.emit('message', 'Start ImgStream');

            socketImgStream.on('connect', () => {
                console.log('Connect to /image_stream')
            })

            socketImgStream.on('img_src', (data) => {
                console.log("img_src: ", data.img_src)
            })

            //socketimgStream.emit('message', 'image_stream')
        });




    </script>
</body>
</html>
